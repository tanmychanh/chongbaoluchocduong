<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>ÄÄƒng nháº­p / ÄÄƒng kÃ½</title>
  <style>
    body { font-family: Arial, sans-serif; background: #fbe9e7; margin:0; }
    .box {
      width: 400px; margin: 80px auto; padding: 25px;
      background: #fff; border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2); text-align: center;
    }
    h2 { color: #c62828; margin-bottom: 20px; }
    input {
      width: 90%; padding: 10px; margin: 8px 0;
      border: 1px solid #ccc; border-radius: 5px;
      transition: border-color 0.3s ease;
    }
    input:focus { border-color: #c62828; outline: none; }
    button {
      width: 95%; padding: 12px; background: #c62828; color: #fff;
      border: none; border-radius: 5px; font-size: 16px; cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button:hover { background: #ff5252; }
    #message { margin-top: 10px; font-weight: bold; }
    .tabs { display: flex; justify-content: center; margin-bottom: 20px; }
    .tabs button {
      flex: 1; padding: 10px; border: none; cursor: pointer;
      background: #eee; font-weight: bold;
    }
    .tabs button.active { background: #c62828; color: #fff; }
    .form { display: none; }
    .form.active { display: block; }
  </style>
</head>
<body>
<div class="box">
  <div class="tabs">
    <button id="loginTab" class="active" onclick="showForm('login')">ÄÄƒng nháº­p</button>
    <button id="registerTab" onclick="showForm('register')">ÄÄƒng kÃ½</button>
  </div>

  <!-- Form ÄÄƒng nháº­p -->
  <div id="loginForm" class="form active">
    <h2>ÄÄƒng nháº­p</h2>
    <input type="text" id="loginUser" placeholder="TÃªn Ä‘Äƒng nháº­p"><br>
    <input type="password" id="loginPass" placeholder="Máº­t kháº©u"><br>
    <button onclick="login()">ÄÄƒng nháº­p</button>
  </div>

  <!-- Form ÄÄƒng kÃ½ -->
  <div id="registerForm" class="form">
    <h2>ÄÄƒng kÃ½ tÃ i khoáº£n</h2>
    <input type="text" id="regUser" placeholder="TÃªn Ä‘Äƒng nháº­p"><br>
    <input type="email" id="regEmail" placeholder="Email"><br>
    <input type="password" id="regPass" placeholder="Máº­t kháº©u"><br>
    <input type="password" id="regConfirm" placeholder="XÃ¡c nháº­n máº­t kháº©u"><br>
    <button onclick="register()">ÄÄƒng kÃ½</button>
  </div>

  <div id="message"></div>
</div>

<script>
function showForm(type) {
  document.getElementById("loginForm").classList.remove("active");
  document.getElementById("registerForm").classList.remove("active");
  document.getElementById("loginTab").classList.remove("active");
  document.getElementById("registerTab").classList.remove("active");

  if(type === "login") {
    document.getElementById("loginForm").classList.add("active");
    document.getElementById("loginTab").classList.add("active");
  } else {
    document.getElementById("registerForm").classList.add("active");
    document.getElementById("registerTab").classList.add("active");
  }
}

function login() {
  const user = document.getElementById("loginUser").value.trim();
  const pass = document.getElementById("loginPass").value.trim();
  const msg = document.getElementById("message");

  if(!user || !pass) {
    msg.innerText = "âš ï¸ Vui lÃ²ng nháº­p Ä‘áº§y Ä‘á»§ thÃ´ng tin!";
    msg.style.color = "#c62828";
    return;
  }

  const users = JSON.parse(localStorage.getItem("users")) || [];
  const found = users.find(u => u.username === user && u.password === pass);

  if(!found) {
    msg.innerText = "âŒ Sai tÃªn Ä‘Äƒng nháº­p hoáº·c máº­t kháº©u!";
    msg.style.color = "#c62828";
    return;
  }

  localStorage.setItem("currentUser", JSON.stringify({
    username: found.username,
    avatar: found.username.charAt(0).toUpperCase()
  }));

  // ğŸ”” Gá»­i thÃ´ng bÃ¡o qua Formspree
  fetch("https://formspree.io/f/xanapvpp", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      message: `ğŸ”” NgÆ°á»i dÃ¹ng ${found.username} vá»«a Ä‘Äƒng nháº­p lÃºc ${new Date().toLocaleString()}`
    })
  });

  msg.innerText = "ğŸ‰ ÄÄƒng nháº­p thÃ nh cÃ´ng! ChÃ o má»«ng " + found.username;
  msg.style.color = "#27ae60";

  setTimeout(() => { window.location.href = "index.html"; }, 1500);
}

function register() {
  const user = document.getElementById("regUser").value.trim();
  const email = document.getElementById("regEmail").value.trim();
  const pass = document.getElementById("regPass").value.trim();
  const confirm = document.getElementById("regConfirm").value.trim();
  const msg = document.getElementById("message");

  if(!user || !email || !pass || !confirm) {
    msg.innerText = "âš ï¸ Vui lÃ²ng nháº­p Ä‘áº§y Ä‘á»§ thÃ´ng tin!";
    msg.style.color = "#c62828";
    return;
  }

  if(pass !== confirm) {
    msg.innerText = "âŒ Máº­t kháº©u xÃ¡c nháº­n khÃ´ng khá»›p!";
    msg.style.color = "#c62828";
    return;
  }

  const users = JSON.parse(localStorage.getItem("users")) || [];
  const exists = users.find(u => u.username === user);
  if(exists) {
    msg.innerText = "âš ï¸ TÃªn Ä‘Äƒng nháº­p Ä‘Ã£ tá»“n táº¡i!";
    msg.style.color = "#c62828";
    return;
  }

  users.push({ username: user, email: email, password: pass });
  localStorage.setItem("users", JSON.stringify(users));

  // ğŸ”” Gá»­i thÃ´ng bÃ¡o qua Formspree
  fetch("https://formspree.io/f/xanapvpp", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      message: `ğŸ†• NgÆ°á»i dÃ¹ng ${user} vá»«a Ä‘Äƒng kÃ½ lÃºc ${new Date().toLocaleString()}`
    })
  });

  msg.innerText = "ğŸ‰ ÄÄƒng kÃ½ thÃ nh cÃ´ng! Vui lÃ²ng Ä‘Äƒng nháº­p.";
  msg.style.color = "#2e7d32";

  setTimeout(() => { showForm('login'); }, 1500);
}
</script>
</body>
</html>